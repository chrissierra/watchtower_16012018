<!doctype html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link href="https://fonts.googleapis.com/css?family=Poiret+One" rel="stylesheet">
  <title>Wombat Coffee Roasters</title>


<!-- Latest compiled and minified CSS -->
<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">

<!-- Optional theme -->
<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap-theme.min.css" integrity="sha384-rHyoN1iRsVXV4nD0JutlnGaslCJuC7uwjduW9SVrLvRYooPp2bWYgmgJQIXwl/Sp" crossorigin="anonymous">

<!-- Latest compiled and minified JavaScript -->
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>

<link rel="stylesheet" href="./src/css/estilo_index.css">

  <meta http-equiv="Content-Security-Policy" 
  content="default-src *; 
           style-src * 'self' 'unsafe-inline' 'unsafe-eval'; 
           script-src * 'self' 'unsafe-inline' 'unsafe-eval';">
 
</head>

<body>

  <header id="header" class="page-header">
    <div class="title">
      <h1>WatchTower</h1>
      <div class="slogan">Electronics for Home</div>
      
                        <button type="button" class="btn btn-default" aria-label="Right Align" style="right:5px; position:absolute; top:50px;" id="botonMenu">
                          <span class="glyphicon glyphicon-align-left" aria-hidden="true"></span>
                        </button>      
    </div>
  </header>

  <nav class="menu" id="main-menu">

    <div class="menu-dropdown">
      <ul class="nav-menu">
        <li><a href="./index.html">Index</a></li>
        <li><a href="./alarmas.html">Alarmas</a></li>
        <li><a href="./afuera.html">Audio</a></li>
        <li><a href="./dirigida.html">CÃ¡mara dirigida</a></li>
      <li><a href="./living.html">Living</a></li>
      </ul>
    </div>
  </nav>


  <main id="main">
      <h3>Living</h3>
  <iframe src="http://181.75.110.235/cams/picture/3/frame/" frameborder="0" width="100%"></iframe>

  <iframe src="http://181.75.110.235/cams/picture/1/frame/" frameborder="0"  width="100%"></iframe>

  <iframe src="http://181.75.110.235/cams/picture/2/frame/" frameborder="0" width="100%"></iframe>
  
<!--
  <audio controls id="audio">
    <source src="http://christophersierrame.ddns.net/audio/">
    
   </audio>


  <button class="btn btn-danger" onclick="comenzar_streaming_audio()">Comenzar Streaming</button>

  -->

  </main>

  




<!--

  <div class="container">
    <input type="checkbox" id="btn"/>
    <label for="btn"></label>
    <div class="time">
      <div class="h_m"></div>
      <div class="s_ms"></div>
    </div>
  </div>


-->


  <script type="text/javascript">

function comenzar_streaming_audio(){
  alert("asdf")
  fetch('http://christophersierrame.ddns.net/vlc_php.php', {mode: 'no-cors'}).then(function(response){
   // alert(response.text());
    return response.text()
  }).then(function(r){
  //  alert("adsafd");
  })
location.reload();
  
}
document.addEventListener("deviceready", onDeviceReady, false);

function onDeviceReady() {
 

 




  window.plugins.OneSignal
  .startInit("6fdf5ca9-9486-4724-b4b9-87edf8f50934")
  .handleNotificationReceived(function(jsonData) {
    alert("Notification received:\n" + JSON.stringify(jsonData));
    console.log('Did I receive a notification: ' + JSON.stringify(jsonData));
  })
  .endInit();





  
  var boton_audio= document.getElementById("btn");
  boton_audio.addEventListener("click", recordAudio, false);



function subir(imageURI) {
 ////alert("inicio upload");
            var options = new FileUploadOptions();
            options.fileKey="file";
            options.fileName="algo.wav";
            options.mimeType="audio/wav";
            //alert("avanzando");
        //alert(imageURI)
 
            var ft = new FileTransfer();
            //alert(ft);
            ft.upload("storage/emulated/0/myrecording.wav", encodeURI("http://181.75.110.235/audio_reproducir.php"), win, fail, options, true);
       
 
        function win(r) {
          alert(r.response);
           
            
        }
 
        function fail(error) {
            alert("An error has occurred: Code = " + error.code);
        }

      }






      function recordAudio() {
    
    //alert(this.getAttribute("id"))
    //this.removeAttribute("id");
    this.setAttribute("class", "termina_grabacion");
    setTimeout(function(){
      var termina= document.getElementsByClassName("termina_grabacion");
      termina[0].addEventListener("click", function asacar(){
        mediaRec.stopRecord();
        //alert("funcion la finalizacion");
        termina[0].removeEventListener("click", asacar, false);
        termina[0].classList.remove("termina_grabacion");
   //location.reload();
      },false)
      //
    }, 90)
    //alert(this.getAttribute("id"))


    var src = "myrecording.wav";
    var mediaRec = new Media(src,subir, function(err) {

          //alert("error")
            console.log("recordAudio():Audio Error: "+ err.code);
        }
    );

    // Record audio
    mediaRec.startRecord();

    // Stop recording after 10 seconds
   // setTimeout(function() {
      //  mediaRec.stopRecord();
   // }, 60000);
}












}
/*
***************************************************************************************************
***************************************************************************************************
*/

    (function () {
      var menuButton = document.getElementById('botonMenu');
      menuButton.addEventListener('click', function(event) {
        event.preventDefault();
        var menu = document.getElementById('main-menu');
        menu.classList.toggle('is-open');
      });
    })();





  </script>
        <script type="text/javascript" src="cordova.js"></script>
   
  
</body>
</html>
